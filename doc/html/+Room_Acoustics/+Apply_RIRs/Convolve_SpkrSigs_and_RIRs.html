<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of Convolve_SpkrSigs_and_RIRs</title>
  <meta name="keywords" content="Convolve_SpkrSigs_and_RIRs">
  <meta name="description" content="CONVOLVE_SPKRSIGS_AND_RIRS Convolves Room Impulse Responses (RIRs) with Loudspeaker Signals">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">+Room_Acoustics</a> &gt; <a href="index.html">+Apply_RIRs</a> &gt; Convolve_SpkrSigs_and_RIRs.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for +Room_Acoustics\+Apply_RIRs&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>Convolve_SpkrSigs_and_RIRs
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>CONVOLVE_SPKRSIGS_AND_RIRS Convolves Room Impulse Responses (RIRs) with Loudspeaker Signals</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [Receiver_Signals] = Convolve_SpkrSigs_and_RIRs( Speaker_Signals, RIRs, Method ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">CONVOLVE_SPKRSIGS_AND_RIRS Convolves Room Impulse Responses (RIRs) with Loudspeaker Signals

 Syntax:    [Receiver_Signals] = CONVOLVE_SPKRSIGS_AND_RIRS( Speaker_Signals, RIRs ) Explain usage here

 Inputs:
     Speaker_Signals - A 2D matrix of Speaker Signals such that each
                     row represents a single loudspeaker signal.
                     Speaker_Signals( NLoudspeakers, Signal_Length )
     RIRs - A 3D matrix of RIRs for each loudspeaker and receiver position
          such that the first dimension is the receivers, the second is
          the length of the RIR and the third is the loudspeakers.
          RIRs( NReceivers, RIR_Length, NLoudspeakers )

 Outputs:
     Receiver_Signals - A 2D matrix comprising of the received signals
     defined by the length of the loudspeaker signals and the number of
     receivers deduced from the sizes of the input matrices.
   Receiver_Signals( NLoudspeakers, NReceivers, Signal_Length + RIR_Length - 1 )

 Example:
     Line 1 of example
     Line 2 of example
     Line 3 of example

 See also: List related files here</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Receiver_Signals] = Convolve_SpkrSigs_and_RIRs( Speaker_Signals, RIRs, Method )</a>
0002 <span class="comment">%CONVOLVE_SPKRSIGS_AND_RIRS Convolves Room Impulse Responses (RIRs) with Loudspeaker Signals</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Syntax:    [Receiver_Signals] = CONVOLVE_SPKRSIGS_AND_RIRS( Speaker_Signals, RIRs ) Explain usage here</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% Inputs:</span>
0007 <span class="comment">%     Speaker_Signals - A 2D matrix of Speaker Signals such that each</span>
0008 <span class="comment">%                     row represents a single loudspeaker signal.</span>
0009 <span class="comment">%                     Speaker_Signals( NLoudspeakers, Signal_Length )</span>
0010 <span class="comment">%     RIRs - A 3D matrix of RIRs for each loudspeaker and receiver position</span>
0011 <span class="comment">%          such that the first dimension is the receivers, the second is</span>
0012 <span class="comment">%          the length of the RIR and the third is the loudspeakers.</span>
0013 <span class="comment">%          RIRs( NReceivers, RIR_Length, NLoudspeakers )</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Outputs:</span>
0016 <span class="comment">%     Receiver_Signals - A 2D matrix comprising of the received signals</span>
0017 <span class="comment">%     defined by the length of the loudspeaker signals and the number of</span>
0018 <span class="comment">%     receivers deduced from the sizes of the input matrices.</span>
0019 <span class="comment">%   Receiver_Signals( NLoudspeakers, NReceivers, Signal_Length + RIR_Length - 1 )</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Example:</span>
0022 <span class="comment">%     Line 1 of example</span>
0023 <span class="comment">%     Line 2 of example</span>
0024 <span class="comment">%     Line 3 of example</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% See also: List related files here</span>
0027 
0028 <span class="comment">% Author: Jacob Donley</span>
0029 <span class="comment">% University of Wollongong</span>
0030 <span class="comment">% Email: jrd089@uowmail.edu.au</span>
0031 <span class="comment">% Copyright: Jacob Donley 2015</span>
0032 <span class="comment">% Date: 04 August 2015</span>
0033 <span class="comment">% Revision: 0.1</span>
0034 <span class="comment">%</span>
0035 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0036 
0037 <span class="comment">% Default Method</span>
0038 <span class="keyword">if</span> nargin &lt; 3
0039     Method = <span class="string">'builtin'</span>;
0040 <span class="keyword">end</span>
0041 
0042 <span class="comment">% Check matrix compatibility</span>
0043 <span class="keyword">if</span> size(Speaker_Signals, 1) ~= size(RIRs, 3)
0044     error(<span class="string">'Number of loudspeakers along the corresponding dimensions does not match!'</span>)
0045 <span class="keyword">end</span>
0046 
0047 NLoudspeakers = size(Speaker_Signals, 1);
0048 NReceivers = size(RIRs,1);
0049 Signal_Length = size(Speaker_Signals, 2);
0050 RIR_Length = size(RIRs, 2);
0051 
0052 Receiver_Signals_Length = Signal_Length + RIR_Length - 1;
0053 
0054 <span class="keyword">if</span> ~strcmp(Method,<span class="string">'FFT'</span>)
0055     Receiver_Signals = zeros(NLoudspeakers, NReceivers, Receiver_Signals_Length, <span class="string">'like'</span>, Speaker_Signals);
0056     
0057     <span class="keyword">for</span> spkr = 1:NLoudspeakers
0058         <span class="keyword">for</span> rec = 1:NReceivers
0059             
0060             spkr_sig = Speaker_Signals(spkr,:);
0061             rir = RIRs(rec,:,spkr);
0062             
0063             <span class="keyword">if</span> strcmp(Method,<span class="string">'builtin'</span>)
0064                 Receiver_Signals( spkr, rec, : ) = conv(spkr_sig,rir);
0065             <span class="keyword">elseif</span> strcmp(Method,<span class="string">'FFT_slow'</span>)
0066                 Receiver_Signals( spkr, rec, : ) = Tools.fconv(spkr_sig.',rir.');
0067             <span class="keyword">end</span>
0068             
0069         <span class="keyword">end</span>
0070     <span class="keyword">end</span>
0071 <span class="keyword">else</span>
0072     Receiver_Signals = zeros(NReceivers, Receiver_Signals_Length, <span class="string">'like'</span>, Speaker_Signals);
0073     <span class="comment">%parfor rec = 1:NReceivers</span>
0074     <span class="keyword">for</span> rec = 1:NReceivers
0075         NRec = length(rec);
0076         spkr_sig = repmat(Speaker_Signals.', 1, NRec);
0077         rir = reshape(permute(RIRs(rec,:,:),[3 1 2]), NRec * NLoudspeakers, RIR_Length).';
0078         
0079         rec_sig = Tools.fconv( spkr_sig, rir );
0080         <span class="comment">%rec_sig = Tools.fconv( gpuArray(spkr_sig), gpuArray(rir) );</span>
0081         
0082         Receiver_Signals(rec,:) = sum(rec_sig,2).';<span class="comment">%reshape( rec_sig', NLoudspeakers, NRec, Receiver_Signals_Length);</span>
0083     
0084     <span class="keyword">end</span>
0085 <span class="keyword">end</span>
0086 
0087             <span class="comment">%Rec_Sigs_B = squeeze(sum(Rec_Sigs_B,1));</span>
0088 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 09-Jul-2017 20:35:18 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>