<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of FlatMasker</title>
  <meta name="keywords" content="FlatMasker">
  <meta name="description" content="FLATMASKER Generates loudspeaker signals for a spatially flat noise masker">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">+Broadband_Tools</a> &gt; <a href="index.html">+Loudspeaker_Signal_Calculation</a> &gt; FlatMasker.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for +Broadband_Tools\+Loudspeaker_Signal_Calculation&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>FlatMasker
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>FLATMASKER Generates loudspeaker signals for a spatially flat noise masker</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function FlatMasker( Signal_Length, SYS_or_LUT_resolution, Noise_Mask_dB, weight, setup ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">FLATMASKER Generates loudspeaker signals for a spatially flat noise masker</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function FlatMasker( Signal_Length, SYS_or_LUT_resolution, Noise_Mask_dB, weight, setup )</a>
0002 <span class="comment">%FLATMASKER Generates loudspeaker signals for a spatially flat noise masker</span>
0003 
0004 SYS_type = <span class="string">'Current_Systems.SR_System'</span>;
0005 
0006 <span class="comment">%% Setup Variables</span>
0007 <span class="keyword">if</span> nargin == 2
0008     <span class="keyword">if</span> isa(SYS_or_LUT_resolution,SYS_type)
0009         SYS = SYS_or_LUT_resolution;        
0010         signal_info = SYS.signal_info;
0011         system_info = SYS.system_info;
0012         setup = SYS.Masker_Setup;
0013         <span class="keyword">if</span> any(size(signal_info.L_noise_mask)~=1)
0014            warning(<span class="string">'Different number of noise levels may not be supported.'</span>); 
0015         <span class="keyword">end</span>
0016     <span class="keyword">else</span>
0017         error([<span class="string">'Second input argument must be of type: '</span> SYS_type]);
0018     <span class="keyword">end</span>
0019 <span class="keyword">elseif</span> nargin == 5
0020     system_info.Drive = <span class="string">'Z:\'</span>; <span class="comment">% Database drive (storage drive)</span>
0021     system_info.LUT_resolution = SYS_or_LUT_resolution;
0022     
0023     signal_info.c = 343; <span class="comment">% Speed of sound in metres/sec</span>
0024     signal_info.Fs = 16000; <span class="comment">% Sampling frequency</span>
0025     signal_info.Nfft = 1024;<span class="comment">% Number of fft components</span>
0026     signal_info.overlap = 0.5;
0027     signal_info.f_low  = 150;  <span class="comment">% Hz</span>
0028     signal_info.f_high = 8000; <span class="comment">% Hz</span>
0029     signal_info.L_noise_mask = Noise_Mask_dB; <span class="comment">% dB</span>
0030     signal_info.weight = weight;
0031     signal_info.method = <span class="string">'FlatMasker'</span>;
0032 <span class="keyword">end</span>
0033 
0034 signal_info.input_filename = <span class="string">'Masker'</span>;
0035 
0036 [Output_path, Output_file_name, Output_file_ext] = <span class="keyword">...</span>
0037     Broadband_Tools.getLoudspeakerSignalPath( setup, signal_info, system_info.LUT_resolution, system_info.Drive, <span class="string">'new'</span>);
0038 
0039 
0040 
0041 <span class="comment">%% Generate Loudspeaker Signals</span>
0042 Loudspeaker_Signals = reshape( v_addnoise( <span class="keyword">...</span><span class="comment"> % White noise</span>
0043                             zeros(Signal_Length,setup.Loudspeaker_Count), <span class="keyword">...</span>
0044                             signal_info.Fs, -Inf), <span class="keyword">...</span>
0045                             [],setup.Loudspeaker_Count) <span class="keyword">...</span>
0046                             * db2mag(signal_info.clipLevelAdjust) <span class="keyword">...</span><span class="comment"> % Adjust level to avoiding clipping</span>
0047                             * db2mag(signal_info.L_noise_mask) <span class="keyword">...</span><span class="comment"> % Adjust level to given value</span>
0048                             / sqrt(setup.Loudspeaker_Count) <span class="keyword">...</span><span class="comment"> % Adjust level for equal power</span>
0049                             * 2 ; <span class="comment">%&lt;- Find out why this helps</span>
0050 
0051                         
0052 <span class="comment">%% Once we have the speaker signals we should save them for later use as .wav files</span>
0053 Broadband_Tools.Loudspeaker_Signal_Calculation.saveLoudspeakerSignals( <span class="keyword">...</span>
0054     Output_path, <span class="keyword">...</span>
0055     Output_file_name, <span class="keyword">...</span>
0056     Output_file_ext, <span class="keyword">...</span>
0057     Loudspeaker_Signals, <span class="keyword">...</span>
0058     [], [], [], [], <span class="keyword">...</span>
0059     signal_info.Fs );
0060 
0061 
0062 <span class="keyword">end</span>
0063 
0064</pre></div>
<hr><address>Generated on Sun 09-Jul-2017 20:35:18 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>